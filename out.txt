Перечень используемых терминов и сокращений: Таблица 1 − Перечень терминов и сокращений
Введение: Настоящее руководство предназначено для установки комплексной цифровой мультиплатформы управления мобильными средствами коммуникаций «UEM SafeMobile» (далее по тексту – UEM SafeMobile) и содержит указания по установке и настройке программного окружения и серверных компонентов «UEM SafeMobile».
Введение: Рисунок 1.1 - Архитектурная схема
Введение: Состав UEM «SafeMobile»
Введение: Клиентские компоненты:
Введение: мобильный клиент:
Введение: iOS – приложение EMM Client и встроенный системный MDM клиент;
Введение: Android – приложение «Monitor»;
Введение: Аврора – приложение EMM-Client «Monitor»;
Введение: Windows – встроенный системный MDM клиент;
Введение: АРМ Администратора.
Введение: Серверные компоненты:
Введение: adagent – агент синхронизации с Microsoft AD. Компонент опционален. Установка требуется, если необходима интеграция системы с Microsoft AD;
Введение: apple-mdm-push – сервис пуш-уведомлений для управления устройствами iOS. Компонент опционален. Установка требуется если планируется управление устройствами на платформе iOS;
Введение: arm – сервер администрирования. Компонент обязателен;
Введение: ca - встроенный УЦ для выпуска сертификатов mTLS. Устанавливается автоматически вместе с компонентом arm и не требует дополнительных настроек;
Введение: db – сервер баз данных. Компонент обязателен;
Введение: fcmpushserver – сервис отправки пуш-уведомлений FCM (для некоторых Android). Использование пуш-сервиса FCM на данный момент опционально и может потребоваться только для управления некоторыми Android-устройствам с урезанной прошивкой, не обеспечивающей автозапуск и защиту MDM-агента от остановки операционной системой.
Введение: file-distr-server - сервер раздачи корпоративных приложений и файлов. Компонент обязателен;
Введение: iosmdm – сервер управления MDM (для Android, iOS, Windows и АврораОС) Компонент обязателен. Предназначен для раздачи профилей, правил управления приложениями, конфигураций приложений на устройства с платформами: iOS, Android и Аврора. Та же компонент обеспечивает доставку команд на устройства платформами: Android и Аврора;
Введение: apple-monitor-push – сервис отправки пуш-уведомлений приложению EMM Client на iOS. Компонент опционален. Установка требуется если планируется управление устройствами на платформе iOS и при этом планируется использование Монитора iOS;
Введение: lmsrv – сервер управления Linux. Компонент опционален. Установка требуется если планируется управление устройствами на платформе Linux;
Введение: mail-agent – сервис отправки электронной почты. Компонент опционален. Установка требуется если планируется использовать доставку уведомлений Администраторам и Сотрудникам по электронной почте;
Введение: nginx – прокси-сервер, обеспечивающий внешние подключения по портам 443, 8443, 8444, 8085(стандартные значения, могут быть изменены). Компонент обязателен. Обеспечивает сетевую связанность компонентов;
Введение: regportal – сервер регистрации устройств. Компонент обязателен. Предназначен для регистрации устройств на платформах: iOS, Android, Аврора и Windows;
Введение: scep – сервер получения пользовательских сертификатов из УЦ по протоколу SCEP. Компонент обязателен. Полученные сертификаты используются для подключения устройств по протоколу mTLS и для профилей, использующих клиентские сертификаты;
Введение: scheduler – планировщик БД. Компонент обязателен. Обеспечивает автоматическое удаление в БД устаревших данных;
Введение: sesl – сервис отправки системных логов. Компонент опционален. Установка требуется если планируется подключение системы к корпоративному агрегатору логов;
Введение: smapi – сервер публичного API. Компонент опционален;
Введение: scim – сервер SCIM. Компонент опционален. Компонент реализует протокол SCIM v2. В текущей реализации не может быть использован из коробки. Если в Вашей компании используется протокол SCIM для управления доступом к ресурсам, обратитесь к коммерческому отделу для обсуждения доработок;
Введение: mdmwss – сервер команд (для Android). Компонент опционален. Предназначен для доставки команд приложению Монитор начиная с версии 10.0. Установка требуется если планируется управление устройствами на платформе Android;
Введение: socket-server – сервер команд (для Android). Компонент опционален. Предназначен для обеспечения обратной совместимости с приложением Монитор версии ниже 10.0. Установка требуется только если необходимо обновление системы с версии ниже 10.0;
Введение: winmdm – сервер управления Windows. Назначение и условия применения. . Компонент опционален. Установка требуется если планируется управление устройствами на платформе Windows.
Введение: В версиях «UEM SafeMobile» 8.х, для аутентификации устройств, используется протокол mTLS (см. раздел 6).
Назначение «UEM SafeMobile»: «UEM SafeMobile» представляет из себя аппаратно-программный комплекс для защиты информации, обрабатываемой на мобильных устройствах, от несанкционированного доступа.
Требования к программному обеспечению: Установка серверных компонентов «UEM SafeMobile» возможна на любой современный 64-разрядный Linux-дистрибутив, если для него доступны пакеты docker, docker-compose, git, postgresql, postgresql-contrib, которые необходимо предварительно установить, в соответствии с документацией вендора ОС.
Требования к программному обеспечению: Работоспособность «UEM SafeMobile» протестирована на следующих ОС:
Требования к программному обеспечению: Debian, Ubuntu, AstraLinux;
Требования к программному обеспечению: RedHat Enterprise Linux, CentOS, OracleLinux, RockyLinux, РЕД ОС;
Требования к программному обеспечению: OpenSUSE, SUSE Linux Enterprise Server (SLES);
Требования к программному обеспечению: ALT Linux, Alpine Linux.
Требования к программному обеспечению: «UEM SafeMobile» может работать с сервером PostgreSQL любой поддерживаемой версии. Работоспособность протестирована на следующих версиях:
Требования к программному обеспечению: PostgreSQL 12, 14, 15;
Требования к программному обеспечению: PostgreSQL Pro 14.
Требования к программному обеспечению: Для примера установки и настройки СУБД на сервере с CentOS7 и Debian 11, в комплекте с дистрибутивом «UEM SafeMobile» поставляются скрипты centos7_pg11_install.sh и debian11_pg14_install.sh
Требования к программному обеспечению: Для входа в веб-консоль администратора требуется один из перечисленных браузеров актуальной версии: Mozilla Firefox, Google Chrome, Яндекс.Браузер.
Системные требования: В таблице 2 указаны рекомендованные системные требования в зависимости от количества МСК, подключаемых к системе. В скобках указаны рекомендуемые серверные компоненты.
Системные требования: Таблица 2.1 – Системные требования для основных компонентов
Системные требования: Таблица 2.2 – Системные требования для опциональных компонентов
Системные требования: *При установке winmdm и lmvsrv на отдельной машине следует обязательно устанавливать MDM TLS сертификат.
Системные требования: Размер диска указан из расчёта, что всё пространство, кроме разделов boot и swap, будет отдано под корень файловой системы.
Системные требования: Таблица 2.3 – Системные требования для 10к+ устройств iOS, Android, Аврора
Системные требования: Таблица 2.4 - Системные требования для работы компонента «Сервер БД (db)» для 10к+ устройств
Системные требования: Таблица 2.5 - Системные требования для опциональных компонентов
Требования к сетевому окружению: Для работы серверных компонентов «UEM SafeMobile» в сетевом окружении требуются разрешения для:
Требования к сетевому окружению: клиентских подключений по следующим TCP-портам (указаны значения по умолчанию):
Требования к сетевому окружению: 8443 (https) – от ПК администратора к Серверу Администрирования;
Требования к сетевому окружению: 443 (https) – от МСК всех платформ к Серверу Управления, Серверу регистрации устройств, Серверу SCEP и Серверу раздачи приложений и файлов;
Требования к сетевому окружению: 443 (https) – от МСК c ОС Windows к Серверу Управления Windows;
Требования к сетевому окружению: 8085 (https) – от внешних сервисов к Серверу API;
Требования к сетевому окружению: 8086 (https) – от внешних сервисов к Серверу SCIM;
Требования к сетевому окружению: 8444 (https)– от МСК c ОС Windows к Серверу Управления Windows.
Требования к сетевому окружению: сетевых подключений серверных компонентов (указаны значения TCP-портов по умолчанию):
Требования к сетевому окружению: 5432 (tcp)– от всех серверных компонентов к Серверу БД;
Требования к сетевому окружению: 636 (ldaps) или 389 (ldap) – от Серверов Администрирования, Регистрации и Агента Синхронизации к Microsoft AD;
Требования к сетевому окружению: 465 (smtps) или 25 (smtp) – от Сервера email-уведомлений к почтовому серверу;
Требования к сетевому окружению: 514 (syslog) – от Сервиса отправки системных логов к хранилищу логов/событий;
Требования к сетевому окружению: 443 (https) – от рабочего места администратора к серверу ГИС для отображения карт (по умолчанию *.openstreetmap.org).
Требования к сетевому окружению: трафика wss между рабочим местом администратора, с которого запускается консоль администрирования арм, и сервером администрирования.
Требования к сетевому окружению: трафика wss от МСК c ОС Android к Серверу команд;
Требования к сетевому окружению: (для управления iOS-устройствами) подключения Сервера Управления к серверам APNS посредством:
Требования к сетевому окружению: доступа к DNS-серверу, разрешающему доменное имя api.push.apple.com;
Требования к сетевому окружению: прохождения IP-трафика к адресам 17.0.0.0/8, TCP-порт 443;
Требования к сетевому окружению: (для управления Android-устройствами, которым требуется 
Firebase Cloud Messaging) подключения пуш-сервера к серверам FCM посредством:
Требования к сетевому окружению: доступа к DNS-серверу, разрешающему доменные имена device-provisioning.googleapis.com android.apis.google.com, mtalk.google.com, mtalk4.google.com, mtalk-staging.google.com, mtalk-dev.google.com, alt1-mtalk.google.com, alt2-mtalk.google.com, alt3-mtalk.google.com, alt4-mtalk.google.com, alt5-mtalk.google.com, alt6-mtalk.google.com, alt7-mtalk.google.com, alt8-mtalk.google.com, firebaseinstallations.googleapis.com;
Требования к сетевому окружению: разрешения прохождения IP-трафика к перечисленным серверам, TCP-порты 443, 5228-5230;
Требования к серверу БД: Для установки схемы БД SafeMobile можно воспользоваться подготовленными скриптами, приведенными в разделе 4.2, либо настроить кластер PostgreSQL вручную, тогда он должен соответствовать следующим требованиям, необходимыми для работы с SafeMobile:
Требования к серверу БД: На сервере должна быть создана база данных с именем, которое впоследствии нужно указать в мастере первоначальной настройки сервера SafeMobile (параметр name в файле db.yml). Кодировка этой БД должна быть en_US.UTF-8.
Требования к серверу БД: Должен быть создан пользователь с правами подключения к этой БД и на создание в ней временных таблиц (далее − пользователь БД SafeMobile). Имя и пароль этого пользователя должны быть впоследствии указаны в мастере первоначальной настройки сервера SafeMobile (параметры user и password в файле db.yml);
Требования к серверу БД: Должна быть создана схема в этой БД, владельцем которой должен быть назначен пользователь БД SafeMobile. А также схема для планировщика с фиксированным названием pgagent.
Требования к серверу БД: В указанной БД в стандартной схеме public должно быть установлено расширение pgcrypto.
Требования к серверу БД: Переменная сессии SEARCH_PATH для роли пользователя БД SafeMobile (п. 2.) должна содержать: <имя схемы БД SafeMobile (п. 2.)>, public.
Требования к серверу БД: В файле pg_hba.conf необходимо проверить и при необходимости добавить строку
Требования к серверу БД: hostnossl all all 0.0.0.0/0 md5
Требования к серверу БД: В файле postgresql.conf необходимо проверить и при необходимости скорректировать параметры:
Требования к серверу БД: jit=off
Требования к серверу БД: listen_addresses = '*'
Требования к серверу БД: max_connections = 1000
Требования к серверу БД: Пример:
Требования к серверу БД: Создаем БД smdb, пользователя smuser, схему smschema
Требования к серверу БД: root@debian:/tmp# su - postgres -c psql
Требования к серверу БД: create database smdb with encoding 'UTF-8' lc_collate 'en_US.UTF-8' lc_ctype 'en_US.UTF-8';
Требования к серверу БД: \connect smdb
Требования к серверу БД: create role smuser with login password '123';
Требования к серверу БД: create schema smschema;
Требования к серверу БД: grant create, usage on schema smschema to smuser;
Требования к серверу БД: create schema pgagent;
Требования к серверу БД: grant create, usage on schema pgagent to smuser;
Требования к серверу БД: create extension pgcrypto schema public;
Требования к серверу БД: alter role smuser set search_path = 'smschema,public';
Требования к серверу БД: Наполняем БД и проверяем результат
Требования к серверу БД: emm@debian:/tmp$ ./install.sh --user smuser --db smdb --schema smschema -- -h 127.0.0.1
Требования к серверу БД: emm@debian:/tmp$ PGPASSWORD=123 psql -U smuser -d smdb -h 127.0.0.1 -c "select * from instlog;"
Требования к сертификатам HTTPS: Сертификаты сервера должны использовать ключи RSA длиной не менее 2048 бит.
Требования к сертификатам HTTPS: Сертификаты сервера должны использовать алгоритм хеширования из семейства SHA-2 для создания цифровой подписи.
Требования к сертификатам HTTPS: Сертификаты сервера должны содержать имя или IP-адрес сервера в поле Subject Alternative Name.
Требования к сертификатам HTTPS: Сертификаты сервера должны включать расширение ExtendedKeyUsage (EKU), содержащее идентификатор объекта id-kp-serverAuth.
Требования к сертификатам HTTPS: Срок действия сертификатов сервера должен составлять не более 825 дней (как указано в полях NotBefore и NotAfter).
Установка и настройка ПО Docker: Установку Docker рекомендуется выполнять из скриптов docker и docker compose для CentOS и Debian, расположенных в каталоге utility, который находится в каталоге /opt/emm (создается после разворачивания архив emm-config.tar.gz).
Установка и настройка серверных компонентов «UEM SafeMobile»: Установка и настройка серверных компонентов «UEM SafeMobile» проще и удобнее выполняется от пользователя root, но может быть произведена и от непривилегированного пользователя, при соблюдении условий (на примере пользователя emm и каталога установки /opt/emm/):
Установка и настройка серверных компонентов «UEM SafeMobile»: Предварительно установлены все необходимые системные компоненты, включая СУБД Postgres, и создан каталог установки
Установка и настройка серверных компонентов «UEM SafeMobile»: mkdir /opt/emm
Установка и настройка серверных компонентов «UEM SafeMobile»: Для каталога установки назначен соответствующий владелец:
Установка и настройка серверных компонентов «UEM SafeMobile»: chown -R emm:emm /opt/emm/
Установка и настройка серверных компонентов «UEM SafeMobile»: Пользователь добавлен в группу docker:
Установка и настройка серверных компонентов «UEM SafeMobile»: groupadd docker; usermod -aG docker emm
Установка и настройка серверных компонентов «UEM SafeMobile»: После этого, все необходимые docker-команды, скрипт первоначальной настройки SafeMobile setup.sh, а также инсталляцию/обновление БД SafeMobile (скрипт install.sh) можно выполнять от пользователя emm.
Установка и настройка серверных компонентов «UEM SafeMobile»: Комплект ПО для установки «UEM SafeMobile» состоит из следующих файлов:
Установка и настройка серверных компонентов «UEM SafeMobile»: emm-config.tar.gz;
Установка и настройка серверных компонентов «UEM SafeMobile»: emm-docker.tar.gz;
Установка и настройка серверных компонентов «UEM SafeMobile»: db-postgresql.tar.gz.
Установка и настройка серверных компонентов «UEM SafeMobile»: Для установки серверных компонентов следует выполнить следующие операции.
Распаковка архивов серверных компонентов: Установить docker-образы серверных компонентов из архива emm-docker.tar.gz:
Распаковка архивов серверных компонентов: docker load -i emm-docker.tar.gz
Распаковка архивов серверных компонентов: Распаковать файлы db-postgresql.tar.gz и emm-config.tar.gz:
Распаковка архивов серверных компонентов: tar xzvf emm-config.tar.gz -C /opt/emm
Распаковка архивов серверных компонентов: tar xzvf db-postgresql.tar.gz -C /tmp/
Установка схемы БД PostgreSQL: Для сервера баз данных PostgreSQL (в терминологии PostgreSQL − кластер PostgreSQL) возможны три сценария установки ПО БД SafeMobile:
Установка схемы БД PostgreSQL: стандартная установка, на сервер с уже имеющейся СУБД PostgreSQL.
Установка схемы БД PostgreSQL: первоначальная установка на новом сервере с ОС Debian 11 или CentOS 7, обычно с минимальным набором пакетов, не включающим в себя PostgreSQL;
Установка схемы БД PostgreSQL: минимальная установка, на сервер с уже имеющейся СУБД PostgreSQL, на котором уже проведена предварительная настройка в соответствии с разделом 2.5.
Установка схемы БД PostgreSQL: Для начала установки необходимо перейти в каталог «/tmp/», в котором после распаковки архива находятся:
Установка схемы БД PostgreSQL: каталог sql
Установка схемы БД PostgreSQL: centos7_pg11_install.sh
Установка схемы БД PostgreSQL: debian11_pg14_install.sh
Установка схемы БД PostgreSQL: INSTALL.md
Установка схемы БД PostgreSQL: install.sh
Установка схемы БД PostgreSQL: setup.sh
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: Пользователям, на сервере которых СУБД PostgreSQL уже установлена, предлагается возможность ее автоматической настройки.
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: Для этого следует от пользователя postgres выполнить скрипт setup.sh:
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: ./setup.sh
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: В результате выполнения данной команды будет создана БД со следующими параметрами по умолчанию: имя базы данных − sphone, имя пользователя − sphone, пароль пользователя − 111.
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: Для получения справки по параметрам скрипта требуется запустить его с ключом -h:
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: ./setup.sh -h
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: Затем установить схему БД командой:
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: ./install.sh -- -h 127.0.0.1
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: После запуска скрипта будет предложена установка схемы БД с параметрами по умолчанию, а именно:
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: File: ./sql/schema.sql   # Название файла для установки
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: Database: sphone   # Имя базы данных
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: User: sphone   # Имя пользователя
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: Schema: sphone   # Название схемы
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: Continuie (y/n)?
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: Для продолжения работы с предложенными параметрами следует нажать «y». В противном случае нажать «n» и запустить скрипт с указанием требуемых параметров. Если какой-то из параметров не указан, будет включено значение параметра по умолчанию.
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: Для получения справки по параметрам скрипта требуется запустить его с ключом -h:
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: ./install.sh -h
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: Пример команды, где smadmin − имя пользователя, smdb − имя базы данных:
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: ./install.sh --user smadmin --db smdb -- -h 127.0.0.1
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: После выбора параметров требуется подтвердить установку схемы БД вводом пароля пользователя.
Стандартная установка на сервер с уже имеющейся СУБД PostgreSQL: После этого можно переходить к разделу 4.2.4 для ручной оптимизации настроек СУБД PostgreSQL
Первоначальная установка на новом сервере: Пользователям, использующим ОС Debian 11 или CentOS 7, на сервере которых СУБД PostgreSQL не установлена, предлагается возможность ее автоматической установки и настройки с оптимальными параметрами.
Первоначальная установка на новом сервере: Для этого следует от пользователя root запустить скрипт командой, соответствующей вашей ОС:
Первоначальная установка на новом сервере: ./debian11_pg14_install.sh
Первоначальная установка на новом сервере: или
Первоначальная установка на новом сервере: ./centos7_pg14_install.sh
Первоначальная установка на новом сервере: В результате выполнения данной команды будет установлена СУБД PostgreSQL и создана БД со следующими параметрами по умолчанию: имя базы данных − sphone, имя пользователя − sphone, пароль пользователя − 111.
Первоначальная установка на новом сервере: Ручная оптимизация настроек описана в разделе 4.2.4.
Первоначальная установка на новом сервере: Затем установить схему БД командой:
Первоначальная установка на новом сервере: ./install.sh -- -h 127.0.0.1
Первоначальная установка на новом сервере: Затем выбрать параметры схемы БД согласно описанию, при стандартной установке после запуска скрипта install.sh.
Первоначальная установка на новом сервере: После этого можно переходить к разделу 4.3 и запускать скрипт первоначальной настройки серверных компонентов
Минимальная установка: Предназначена для пользователей, у которых уже установлена СУБД PostgreSQL, создана БД и настроена в соответствии с требованиями в разделе 2.5.
Минимальная установка: Для того, чтобы установить схему БД необходимо запустить скрипт командой:
Минимальная установка: ./install.sh -- -h 127.0.0.1 -p 5433
Минимальная установка: “-p 5433” – указывается, если используется нестандартный порт, отличный от 5432.
Минимальная установка: После выбора параметров требуется подтвердить установку схемы БД вводом пароля пользователя.
Ручная оптимизация настроек СУБД PostgreSQL: Для оптимизации настроек СУБД PostgreSQL с целью обеспечения хорошей производительности сервера, необходимо внести изменения в файл:
Ручная оптимизация настроек СУБД PostgreSQL: postgresql.conf 
(стандартный путь для PostgreSQL 11: /var/lib/pgsql/11/data/postgresql.conf).
Ручная оптимизация настроек СУБД PostgreSQL: Для получения списка рекомендуемых настроек следует запустить скрипт ./make_pg_conf.sh на компьютере, где установлен PostgreSQL, список отобразится на экране.
Ручная оптимизация настроек СУБД PostgreSQL: После внесения изменений необходимо перезапустить БД:
Ручная оптимизация настроек СУБД PostgreSQL: systemctl restart postgresql-11.service
Настройка СУБД PostgreSQL при работе в отдельной подсети: Серверные компоненты SafeMobile поддерживают пул соединений с сервером БД, на случай всплеска активности мобильных клиентов. Если сервер БД находится в отдельной подсети, пограничное активное сетевое оборудование может разрывать соединения, находящиеся в резерве. При этом, в логах PostgreSQL появляется множество ошибок "could not receive data from client: Connection timed out".
Настройка СУБД PostgreSQL при работе в отдельной подсети: В этом случае необходимо скорректировать параметры PostgreSQL. Например, если активное сетевое оборудование разрывает все соединения, неактивные в течение 30 секунд, рекомендуется выставить следующе параметры в файле postgresql.conf
Настройка СУБД PostgreSQL при работе в отдельной подсети: tcp_keepalives_idle = 20 # TCP_KEEPIDLE, in seconds;
Настройка СУБД PostgreSQL при работе в отдельной подсети: tcp_keepalives_interval = 1 # TCP_KEEPINTVL, in seconds;
Настройка СУБД PostgreSQL при работе в отдельной подсети: tcp_keepalives_count = 9 # TCP_KEEPCNT;
Настройка СУБД PostgreSQL при работе в отдельной подсети: и перезапустить сервис PostgreSQL.
Настройка СУБД PostgreSQL при работе в отдельной подсети: Для просмотра параметров, использующихся сервером в данным момент, необходимо выполнить команду:
Настройка СУБД PostgreSQL при работе в отдельной подсети: psql -U sphone -h 127.0.0.1 -c " select name, setting, unit from pg_settings where name like 'tcp%';"
Подключение к СУБД PostgreSQL по сертификату: Скрипт установки и обновления схемы БД install.sh поддерживает подключение по сертификату. Для этого необходимо указать параметр --ssl и отредактировать файл настроек ssl-connection-settings.sh, находящийся в том же каталоге, что и скрипт. В файле настроек указаны пути к файлам клиентского сертификата, ключа клиентского сертификата и сертификата CA.
Подключение к СУБД PostgreSQL по сертификату: Для подключения по сертификату необходимо выпустить сертификат для сервера СУБД PostgreSQL, настроить СУБД PostgreSQL, выпустить клиентский сертфикат для подключения.
Подключение к СУБД PostgreSQL по сертификату: Информация ниже приводится для ознакомления, подробная информация содержится в документации PostgreSQL.
Подключение к СУБД PostgreSQL по сертификату: 4.2.6.1 Выпуск сертификатов, подписанных самоподписанным сертификатом CA
Подключение к СУБД PostgreSQL по сертификату: Создание ключа сертификата CA:
Подключение к СУБД PostgreSQL по сертификату: openssl genrsa -out root.key 4096
Подключение к СУБД PostgreSQL по сертификату: Создание сертификата CA. В интерактивном режиме в Common Name (CN) указать не IP-адрес сервера, а любое название, например "MyCompanyCA":
Подключение к СУБД PostgreSQL по сертификату: openssl req -x509 -new -nodes -key root.key -sha256 -days 365 -out root.crt
Подключение к СУБД PostgreSQL по сертификату: Создание ключа сертификата сервера:
Подключение к СУБД PostgreSQL по сертификату: openssl genrsa -out server.key 2048
Подключение к СУБД PostgreSQL по сертификату: Создание запроса на сертификат сервера. В интерактивном режиме в Common Name (CN) указать IP-адрес сервера, например "10.17.7.88":
Подключение к СУБД PostgreSQL по сертификату: openssl req -new -key server.key -out server.csr
Подключение к СУБД PostgreSQL по сертификату: Создание и подпись сертификата сервера:
Подключение к СУБД PostgreSQL по сертификату: openssl x509 -req -in server.csr -CA root.crt -CAkey root.key -CAcreateserial -out server.crt -days 365 -sha256
Подключение к СУБД PostgreSQL по сертификату: Создание ключа сертификата клиента:
Подключение к СУБД PostgreSQL по сертификату: openssl genrsa -out client.key 2048
Подключение к СУБД PostgreSQL по сертификату: Создание запроса на сертификат клиента. В интерактивном режиме в Common Name (CN) указать имя пользователя PostgreSQL, обычно "sphone":
Подключение к СУБД PostgreSQL по сертификату: openssl req -new -key client.key -out client.csr
Подключение к СУБД PostgreSQL по сертификату: Создание и подпись сертификата клиента:
Подключение к СУБД PostgreSQL по сертификату: openssl x509 -req -in client.csr -CA root.crt -CAkey root.key -CAcreateserial -out client.crt -days 365 -sha256
Подключение к СУБД PostgreSQL по сертификату: Настройка СУБД PostgreSQL
Подключение к СУБД PostgreSQL по сертификату: Файлы сертификатов root.crt, server.crt, server.key скопировать в каталог установки кластера PostgreSQL. Для файлов выполнить:
Подключение к СУБД PostgreSQL по сертификату: chown postgres
Подключение к СУБД PostgreSQL по сертификату: chmod 400
Подключение к СУБД PostgreSQL по сертификату: Указать параметры в postgresql.conf:
Подключение к СУБД PostgreSQL по сертификату: ssl = on
Подключение к СУБД PostgreSQL по сертификату: ssl_ca_file = 'root.crt'
Подключение к СУБД PostgreSQL по сертификату: ssl_cert_file = 'server.crt'
Подключение к СУБД PostgreSQL по сертификату: ssl_key_file = 'server.key'
Подключение к СУБД PostgreSQL по сертификату: В pg_hba.conf добавить:
Подключение к СУБД PostgreSQL по сертификату: Для версии PostgreSQL 11:
Подключение к СУБД PostgreSQL по сертификату: hostssl all all 0.0.0.0/0 cert  clientcert=1 #
Подключение к СУБД PostgreSQL по сертификату: Для версии PostgreSQL 12 и выше:
Подключение к СУБД PostgreSQL по сертификату: hostssl all all 0.0.0.0/0 cert  clientcert=verify-full #
Подключение к СУБД PostgreSQL по сертификату: Перезапустить кластер PostgreSQL.
Подключение к СУБД PostgreSQL по сертификату: 4.2.6.3	Подключение по сертификату
Подключение к СУБД PostgreSQL по сертификату: psql "host=10.17.7.88 port=5438 dbname=sphone user=sphone sslmode=verify-full sslcert=/distrib/certs/client.crt sslkey=/distrib/certs/client.key sslrootcert=/distrib/certs/root.crt"
Подключение к СУБД PostgreSQL по сертификату: host - как в Common Name server.crt
Подключение к СУБД PostgreSQL по сертификату: user - как в Common Name client.crt
Подключение к СУБД PostgreSQL по сертификату: chown root client.key
Подключение к СУБД PostgreSQL по сертификату: chgrp 2000 client.key
Подключение к СУБД PostgreSQL по сертификату: chmod 640 client.key
Запуск скрипта первоначальной настройки серверных компонентов: Для работы скрипта первоначальной настройки необходимо ПО Git.
Запуск скрипта первоначальной настройки серверных компонентов: Скрипт первоначальной настройки setup.sh, находится в каталоге «/opt/emm». После его запуска необходимо ответить на вопросы для создания конфигурационных файлов серверных компонентов и файла «docker-compose.yml», выбранных для установки на этом сервере (для ответов на вопросы предоставляются подсказки: y − да, n − нет, q − выход из настройки, ? − справочная информация):
Запуск скрипта первоначальной настройки серверных компонентов: Bind IP: 0.0.0.0
Запуск скрипта первоначальной настройки серверных компонентов: Изменение дефолтного значения 0.0.0.0 может потребоваться при особых условиях настройки сервера с несколькими ip-адресами
Запуск скрипта первоначальной настройки серверных компонентов: 2.	MDM: behind external proxy? [y/n/q/?] y
Запуск скрипта первоначальной настройки серверных компонентов: Указать, расположены ли Сервера Управления (iosmdm и winmdm) за каким-либо внешним прокси-сервером. При выборе режима работы за внешним прокси-сервером, на внешнем прокси-сервере необходимо настроить передачу клиентских сертификатов с прокси-сервера на Сервера Управления. Пример настройки внешнего прокси-сервера приведен разделе 6.
Запуск скрипта первоначальной настройки серверных компонентов: 3.	ARM [y/n/q/?]? y
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию Сервера администрирования.
Запуск скрипта первоначальной настройки серверных компонентов: 4.	ARM: Use HTTPS [y/n/q/?]? y
Запуск скрипта первоначальной настройки серверных компонентов: Использовать протокол HTTPS для сервера администрирования.
Запуск скрипта первоначальной настройки серверных компонентов: 5. Если конфиг уже был установлен:
Запуск скрипта первоначальной настройки серверных компонентов: ARM: Old TLS certificate exists, create new? [y/n/q/?]? y
Запуск скрипта первоначальной настройки серверных компонентов: При установке в первый раз -
Запуск скрипта первоначальной настройки серверных компонентов: ARM: Create TLS certificate? [y/n/q/?]? y
Запуск скрипта первоначальной настройки серверных компонентов: 6.	ARM: Common Name (IP or domain name): 192.168.1.1
Запуск скрипта первоначальной настройки серверных компонентов: Адрес или доменное имя для сертификата сервера администрирования.
Запуск скрипта первоначальной настройки серверных компонентов: 7.	MDM server [y/n/q/?]? y
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию сервера управления MDM
Запуск скрипта первоначальной настройки серверных компонентов: 8.	APNS MDM push server? [y/n/q/?]? y
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию push sever управления устройствами iOS
Запуск скрипта первоначальной настройки серверных компонентов: 9.	APNS SafeMobile monitor push server? [y/n/q/?]? y
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию push server клиента SafeMobile (iOS)
Запуск скрипта первоначальной настройки серверных компонентов: 10.	SCEP server? [y/n/q/?]? y
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию SCEP сервера.
Запуск скрипта первоначальной настройки серверных компонентов: 11.	File Distribution Server? [y/n/q/?]? y
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию сервера раздачи приложений
Запуск скрипта первоначальной настройки серверных компонентов: 12.	Android control server (WebSocket)? (mdm-wss)
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию Сервера команд (MDM WebSocket serever)
Запуск скрипта первоначальной настройки серверных компонентов: 13.	Windows MDM? [y/n/q/?] y
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию сервера WinMDM
Запуск скрипта первоначальной настройки серверных компонентов: 14.	FCM Push Server? [y/n/q/?] y
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию пуш-сервера FCM
Запуск скрипта первоначальной настройки серверных компонентов: 15.	Socket server [y/n/q/?]?
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию Сервера команд (Socket server - устарел). Установка требуется только при обновлении системы с версии ниже 10.0 и наличии в системе подключенных устройств Android - y. В прочих случаях выбрать – n.
Запуск скрипта первоначальной настройки серверных компонентов: 16. При установке в первый раз:
Запуск скрипта первоначальной настройки серверных компонентов: Socket server: Create TLS certificate? y
Запуск скрипта первоначальной настройки серверных компонентов: Если конфиг уже был установлен:
Запуск скрипта первоначальной настройки серверных компонентов: Socket server: Old TLS certificate exists, create new? y
Запуск скрипта первоначальной настройки серверных компонентов: 17. Socket server: Common Name (IP or domain name): 192.168.1.1
Запуск скрипта первоначальной настройки серверных компонентов: Адрес или доменное имя для сертификата Сервера команд
Запуск скрипта первоначальной настройки серверных компонентов: 18. Linux Management Server? y
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию Сервера управления Linux
Запуск скрипта первоначальной настройки серверных компонентов: 19. AD Sync Agent? y
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию Сервера синхронизации с Microsoft AD
Запуск скрипта первоначальной настройки серверных компонентов: 20. SafeMobile API Server? y
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию Сервера API
Запуск скрипта первоначальной настройки серверных компонентов: 21. При установке в первый раз:
Запуск скрипта первоначальной настройки серверных компонентов: SafeMobile API Server: Create TLS certificate? y
Запуск скрипта первоначальной настройки серверных компонентов: Если конфиг уже был установлен:
Запуск скрипта первоначальной настройки серверных компонентов: SafeMobile API Server: Old TLS certificate exists, create new? y
Запуск скрипта первоначальной настройки серверных компонентов: 22. SafeMobile API Server: Common Name (IP or domain name): 192.168.1.1
Запуск скрипта первоначальной настройки серверных компонентов: Адрес или доменное имя для сертификата Сервера API
Запуск скрипта первоначальной настройки серверных компонентов: 23. Mail Service? y
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию Сервера email-уведомлений
Запуск скрипта первоначальной настройки серверных компонентов: 24. Syslog Forward Service? y
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию Сервера syslog
Запуск скрипта первоначальной настройки серверных компонентов: 25. SCIM server? y
Запуск скрипта первоначальной настройки серверных компонентов: Сформировать конфигурацию SCIM server (API для управления учетными данными администратора)
Запуск скрипта первоначальной настройки серверных компонентов: 26. При установке в первый раз:
Запуск скрипта первоначальной настройки серверных компонентов: SafeMobile SCIM Server: Create TLS certificate? y
Запуск скрипта первоначальной настройки серверных компонентов: Если конфиг уже был установлен:
Запуск скрипта первоначальной настройки серверных компонентов: SafeMobile SCIM Server: Old TLS certificate exists, create new? y
Запуск скрипта первоначальной настройки серверных компонентов: 27. SCIM Server: Common Name (IP or domain name): 192.168.1.1
Запуск скрипта первоначальной настройки серверных компонентов: Адрес или доменное имя для сертификата SCIM сервера
Запуск скрипта первоначальной настройки серверных компонентов: 28. Database hostname: 192.168.1.1
Запуск скрипта первоначальной настройки серверных компонентов: Адрес сервера БД
Запуск скрипта первоначальной настройки серверных компонентов: 29. Database port (default: 5432): 5432
Запуск скрипта первоначальной настройки серверных компонентов: Порт сервера БД
Запуск скрипта первоначальной настройки серверных компонентов: 30. Database name: sphone
Запуск скрипта первоначальной настройки серверных компонентов: Имя БД
Запуск скрипта первоначальной настройки серверных компонентов: 31. Database username: sphone
Запуск скрипта первоначальной настройки серверных компонентов: Пользователь БД
Запуск скрипта первоначальной настройки серверных компонентов: 32. Database password:
Запуск скрипта первоначальной настройки серверных компонентов: Пароль пользователя БД
Запуск скрипта первоначальной настройки серверных компонентов: 33. Если конфиг уже был установлен:
Запуск скрипта первоначальной настройки серверных компонентов: MDM: Old TLS certificate exists, create new? y
Запуск скрипта первоначальной настройки серверных компонентов: При установке в первый раз
Запуск скрипта первоначальной настройки серверных компонентов: MDM: Create TLS certificate? y
Запуск скрипта первоначальной настройки серверных компонентов: 34. MDM: Common Name (IP or domain name): 192.168.1.1
Запуск скрипта первоначальной настройки серверных компонентов: Адрес или доменное имя для сертификата MDM сервера (а также для прочих серверов, работающих на порту 443: Сервер управления, Сервера регистрации устройств, Сервера команд, Сервера SCEP, Сервера раздачи приложений и файлов)
Конфигурационные файлы: В результате выполнения скрипта setup.sh в каталоге «/opt/emm» сформируются конфигурационные файлы серверных компонентов SafeMobile(в подкаталоге «config») и файл «docker-compose.yml», состав и настройки которых будут соответствовать заданным параметрам.
Конфигурационные файлы: Затем можно изменить количество неправильных попыток ввода пароля в конфигурационном файле «config/nginx/arm.http.conf», в параметре rate=*. Пример файла приведен ниже, в котором по умолчанию количество попыток авторизаций в минуту равно 3.
Конфигурационные файлы: map $server_name $arm_external_url {
Конфигурационные файлы: …
Конфигурационные файлы: limit_req_zone $arm_login_zone_key zone=arm_login:10m rate=3r/m   # Количество попыток авторизаций в минуту = `3`
Конфигурационные файлы: …
Конфигурационные файлы: }
Конфигурационные файлы: В конфигурационном файле «config/arm.yml» можно выполнить настройку максимального размера файла для отправки командой «Отправить файл», изменив значение по умолчанию 100МБ:
Конфигурационные файлы: arm.cmd-send-file.max-file-size: 100MB
Конфигурационные файлы: Также в конфигурационном файле «config/arm.yml» можно изменить ссылку на Монитор для QR-кода, генерируемого в разделе Загрузчик, добавив параметр:
Конфигурационные файлы: safemobile.url_for_monitor_download: https://my.url/monitor.apk
Конфигурационные файлы: Чтобы установить максимальный размер шаблонов писем следует изменить параметр:
Конфигурационные файлы: mail:
Конфигурационные файлы: template.max_total_size: 50MB
Настройки сервиса отправки почты: В конфигурационном файле «config/mail.yml» компонента mail-agent нужно указать настройки SMTP-сервера и учетную запись для отправки пользователям писем правил несоответствия и кодов приглашения, а также уведомлений администраторов о блокировке/разблокировке их учётных записей.
Настройки сервиса отправки почты: Параметры mail.yml
Настройки сервиса отправки почты: password – Если закомментировать пароль, то будет использована анонимная аутентификация;
Настройки сервиса отправки почты: sender – Пользователь отправитель сообщений. Задается в виде user@domain.ru. Если параметр не задан, то вместо sender будет применяться параметр user.
Настройки сервиса отправки почты: serverCertificate – путь к сетевому сертификату;
Настройки сервиса отправки почты: checkRevocation – проверять отзыв серверного сертификата;
Настройки сервиса отправки почты: checkHostname – проверять соответствие имени хоста серверному сертификату;
Настройки сервиса отправки почты: checkCertificate – проверять ли серверный сертификат;
Настройки сервиса отправки почты: tlsOptions – Настройки TLS. Возможные значения:
Настройки сервиса отправки почты: None – не использовать шифрование TLS;
Настройки сервиса отправки почты: Auto – автоматически определять, какие параметры TLS будут использованы. Если сервер не поддерживает TLS, соединение продолжится без какого-либо шифрования;
Настройки сервиса отправки почты: SslOnConnect – Соединение должно сразу при подключении к серверу использовать шифрование TLS;
Настройки сервиса отправки почты: StartTls – шифрование TLS включается после получения приветствия и параметров совместимости сервера. Если сервер не поддерживает опцию STARTTLS, соединение завершится неудачей;
Настройки сервиса отправки почты: StartTlsWhenAvailable – шифрование TLS включается после получения приветствия и параметров совместимости сервера, но только когда сервер поддерживает опцию STARTTLS.
Настройки сервиса отправки почты: limit – максимальное количество писем которое может быть отправлено за промежуток времени, заданный в параметре window;
Настройки сервиса отправки почты: window – расчетный промежуток времени в секундах для параметра limit.
Создание docker-контейнеров: Запустить установку docker-контейнеров с помощью команды:
Создание docker-контейнеров: docker-compose up -d
Создание docker-контейнеров: Проверить наличие загруженных docker-образов и созданных docker-контейнеров следующими командами:
Создание docker-контейнеров: docker images -a
Создание docker-контейнеров: docker ps -a
Создание docker-контейнеров: Если в результате проверки, кроме созданных компонентов, отобразились docker-образы и docker-контейнеры от более ранних версий системы, их следует удалить.
Настройка раздела «Подключения к серверам» в АРМ: После настройки всех серверных компонентов, входа в консоль администрирования и ввода лицензии, в первую очередь необходимо произвести настройки, необходимые мобильным устройствам для подключения к серверу. Для этого предназначен раздел «Подключения к серверам». С его помощью можно настроить только параметры, передаваемые мобильным клиентам для связи с сервером. Физическая настройка адресов, портов и сертификатов, отдаваемых сервером по сети, происходит в мастере первоначальной настройки SafeMobile и конфигурационных файлах, и представлена ранее в этом документе.
Настройка раздела «Подключения к серверам» в АРМ: При первичной установке, настройке SCEPServer следует задать те же настройки, что и в MDMServer. Указание настройки обязательно. Если настройки SCEPServer не заданы, то подключение устройств к системе будет невозможно, т.к устройство не сможет получить сертификат mTLS.
Настройка раздела «Подключения к серверам» в АРМ: 1) Если сервер использует сертификаты, выданные общедоступным доверенным УЦ(GlobalSign, DigiCert, Let's Encrypt и т.п.), доверие серверу со стороны мобильных клиентов не требует дополнительной настройки и достаточно указать только адреса:порты сервера (рисунок 4.1).
Настройка раздела «Подключения к серверам» в АРМ: Рисунок 4.1 – пример адреса и порты сервера
Настройка раздела «Подключения к серверам» в АРМ: 2) Если сервер использует сертификаты, выданные корпоративным УЦ или полученные с помощью мастера первоначальной настройки SafeMobile, мобильным клиентам при подключении необходимо передать корневой сертификат УЦ, для доверия серверу. В случае мастера первоначальной настройки SafeMobile создается свой мини-УЦ и его корневой сертификат лежит в каталоге установки сервера, в файле CA.pem.
Настройка раздела «Подключения к серверам» в АРМ: Корневой сертификат УЦ необходимо загрузить в АРМ, в раздел «Серверные сертификаты», после чего в разделе «Подключения к серверам» появится возможность назначить этот доверенный сертификат на URL (рисунок 4.2).
Настройка раздела «Подключения к серверам» в АРМ: Рисунок 4.2– назначенные серверные сертификаты
Получение цифровых сертификатов и ключей: Для создания запроса и генерации ключа используется криптографический пакет OpenSSL.
Сертификаты HTTPS: Для работы серверных компонентов SafeMobile по протоколу HTTPS, потребуются сертификаты и ключи:
Сертификаты HTTPS: iosmdm.crt − сертификат сервера управления MDM;
Сертификаты HTTPS: iosmdm.key − приватный ключ сервера управления MDM;
Сертификаты HTTPS: arm.crt − сертификат сервера администрирования;
Сертификаты HTTPS: arm.key − приватный ключ сервера администрирования;
Сертификаты HTTPS: ss.crt − сертификат сервера команд;
Сертификаты HTTPS: ss.key − приватный ключ сервера команд.
Сертификаты HTTPS: Генерация приватных ключей с формированием долгосрочных самоподписанных сертификатов выполняется при запуске скрипта первоначальной настройки в соответствии с описанием в 4.2.5.
Сертификаты HTTPS: Проверить, что сертификаты и ключи автоматически помещены в конфигурационный каталог, а именно:
Сертификаты HTTPS: iosmdm.crt и iosmdm.key в /opt/emm/config/;
Сертификаты HTTPS: ss.crt, ss.key, arm.crt и arm.key в /opt/emm/config/nginx/.
Сертификаты HTTPS: Если серверные компоненты, которым требуются HTTPS сертификаты и ключи расположены на разных серверах, следует сертификаты и ключи переместить на целевые серверы в указанные каталоги.
Сертификаты HTTPS: При нежелании использовать самоподписанные сертификаты, следует получить HTTPS-сертификаты в доверенном УЦ. Для этого необходимо выполнить следующие действия:
Сертификаты HTTPS: Сгенерировать ключи и сформировать запросы на выпуск сертификатов в формате CSR следующей командой (пример для сервера управления MDM):
Сертификаты HTTPS: openssl req -out iosmdm.csr -new -newkey rsa:2048 -nodes -keyout iosmdm.key
Сертификаты HTTPS: Направить csr-файлы в УЦ. После проверки данных, указанных в запросе, будет выписан сертификат.
Сертификаты HTTPS: Полученные сертификаты и ключи поместить в конфигурационный каталог, как было описано в данном подразделе.
Сертификаты HTTPS: В файл «iosmdm.crt» сертификата сервера управления MDM необходимо занести всю цепочку сертификатов следующим образом:
Сертификаты HTTPS: -----BEGIN CERTIFICATE-----
сертификат сервера
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
промежуточный сертификат
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
корневой сертификат
-----END CERTIFICATE-----
Сертификаты HTTPS: Если используется внешний прокси-сервер, то на нем также должна использоваться цепочка сертификатов (см. п.4).
Сертификат Push MDM: Для возможности управления МСК на платформе iOS потребуется сертификат и ключ APNS для сервера управления MDM.
Сертификат Push MDM: После установки и запуска сервис apple-mdm-push будет находиться в циклической перезагрузке, пока не будет получен валидный файл MDMPush.pem.
Сертификат Push MDM: Для получения сертификата Push MDM необходимо выполнить следующие действия:
Сертификат Push MDM: Для запуска процесса генерации приватного ключа и формирования запроса на сертификат в формате CSR выполнить команду:
Сертификат Push MDM: openssl req -new -newkey rsa:2048 -nodes -keyout MdmPush.key  -subj '/C=RU/ST=Moscow/CN=MdmPush' -out MdmPush.csr
Сертификат Push MDM: В запросе допустимо заменить город Москва на любой другой город Российской Федерации.
Сертификат Push MDM: По окончанию генерации ключа и запроса на сертификат будут сформированы два файла:
Сертификат Push MDM: MdmPush.csr− запрос на сертификат;
Сертификат Push MDM: MdmPush.key − приватный ключ.
Сертификат Push MDM: Файл MdmPush.csr следует приложить к заявке на Портале Технической Поддержки НИИ СОКБ https://service.niisokb.ru/. Подписанный файл CSR будет возвращён в формате PLIST.
Сертификат Push MDM: После получения PLIST-файла, необходимо в браузере перейти на страницу https://identity.apple.com/pushcert/ и зайти на портал регистрации сертификатов для push-уведомлений (Apple Push Certificates Portal) посредством своей учетной записи (Apple ID).
Сертификат Push MDM: На портале регистрации сертификатов для push-уведомлений следует выполнить следующие действия:
Сертификат Push MDM: нажать «Create a Certificate» (Создать сертификат);
Сертификат Push MDM: ознакомиться и согласиться с предложенными условиями, установив галочку в поле «I have read and agree to these terms and conditions» и нажав на «Accept» (Принять);
Сертификат Push MDM: нажать «Browse» (Обзор), перейти на подписанный файл MdmPush.plist на своем компьютере, выбрать его и нажать «Upload» (Загрузить);
Сертификат Push MDM: для получения файла сертификата в формате PEM нажать «Download» (Скачать) и скачать файл с названием MDM_Certificate.pem.
Сертификат Push MDM: Файлы MdmPush.key и MDM_Certificate.pem поместить в конфигурационный каталог /opt/emm/config/, при условии, что SafeMobile будет установлен в /opt/emm/.
Сертификат Push MDM: Объединить файлы сертификата и приватного ключа в один файл MdmPush.pem:
Сертификат Push MDM: echo >> MDM_Certificate.pem;cat MDM_Certificate.pem MdmPush.key | grep -Ev "^$" > MdmPush.pem
Сертификат Push MDM: Полученный сертификат выдается на один год и должен быть своевременно обновлен в соответствии с регламентом, изложенным в этом подразделе.
Сертификат Push MDM: Для обновления сертификата Push MDM необходимо выполнить следующие действия:
Сертификат Push MDM: Можно использовать исходный файл MdmPush.csr, или сформировать новый запрос с использованием старого ключа следующей командой:
Сертификат Push MDM: openssl req -new -key MdmPush.key -subj '/C=RU/ST=Moscow/CN=MdmPush' -out MdmPush.csr
Сертификат Push MDM: Файл MdmPush.csr следует приложить к заявке на Портале Технической Поддержки НИИ СОКБ https://service.niisokb.ru/. Подписанный файл CSR будет возвращён в формате PLIST.
Сертификат Push MDM: В браузере перейти на страницу https://identity.apple.com/pushcert/ и зайти на портал регистрации сертификатов для push-уведомлений (Apple Push Certificates Portal) посредством своей учетной записи (Apple ID/Password).
Сертификат Push MDM: На портале регистрации сертификатов для push-уведомлений следует выполнить следующие действия:
Сертификат Push MDM: выбрать строку с сертификатом, подлежащим обновлению, и нажать «Renew» (Обновить);
Сертификат Push MDM: Примечание − При обновлении сертификата не следует нажимать «Download» (Скачать) или «Revoke» (Отозвать), т.к. оба эти параметра потребуют повторной регистрации всех МСК на платформе iOS.
Сертификат Push MDM: нажать «Browse» (Обзор), перейти на подписанный файл MdmPush.plist на своем компьютере, выбрать его и нажать «Upload» (Загрузить);
Сертификат Push MDM: для получения файла сертификата в формате PEM нажать «Download» (Скачать).
Сертификат Push MDM: В конфигурационном каталоге /opt/emm/config/ открыть файл MdmPush.pem и скопировать в него строки из обновленного сертификата, заменив информацию об истекшем сертификате, а информацию о приватном ключе оставив без изменений. Сохранить внесенные изменения.
Сертификат Push MDM: Пример файла MdmPush.pem приведен ниже:
Сертификат Push MDM: -----BEGIN CERTIFICATE-----
вставить содержимое обновленного сертификата
-----END CERTIFICATE-----
-----BEGIN RSA PRIVATE KEY-----
оставить без изменений
-----END RSA PRIVATE KEY-----
Сертификат Push MDM: Перезапустить docker-контейнеры для сервера управления MDM следующей командой:
Сертификат Push MDM: docker-compose restart iosmdm apple-mdm-push
Сертификат Push MDM: При необходимости отзыва сертификата Push MDM следует на портале регистрации в строке с выбранным сертификатом нажать «Revoke» (Отозвать).
Приватный ключ пуш-сервера FCM: После установки и запуска серверный компонент fcmpushserver находится в циклической перезагрузке, пока не будет получен валидный файл firebase.json.
Приватный ключ пуш-сервера FCM: Для включения пуш-сервера следует создать заявку на Портале Технической Поддержки НИИ СОКБ https://service.niisokb.ru/. В ответ будет прислан файл firebase.json, который необходимо разместить в каталог /opt/emm/config/, при условии, что SafeMobile  установлен в /opt/emm/.
Сертификат SCEP: Сертификат SCEP генерируется автоматически инсталлятором в каталоге установки (файл scep.p12). Сертификат используется для подписи запросов сертификата. Если используется схема с несколькими серверами MDM расположенными за внешним балансировщиком, то необходимо обеспечить чтобы все сервера использовали один сертификат scep.
Особенности обновления с версий 8.2 - 9.x: В версии 10.х экземпляр Сервера SCEP более не устанавливается автоматически вместе с Сервером MDM. При установке обновления, Сервер SCEP должен быть установлен вручную. Если ранее использовался автоматически установленный Сервер SCEP, то при обновлении его предпочтительнее устанавливать на ту же виртуальную машину, что и Сервер MDM (см. таблицу 2.1 – Системные требования для основных компонентов).
Особенности обновления с версий 8.2 - 9.x: В версии 10.0 компонент SocketServer работающий по проприетарному TCP протоколу был заменен на компонент Command Server (mdmwss). Но для выполнения обновления приложений Монитор Андроид с версий старше 10.0 – необходима установка обоих компонентов и SocketServer, и Command Server. Компонент SocketServer можно отключить и удалить после того, как будут обновлены приложения Монитор на всех подключенных устройствах Android.
Особенности обновления с версии 7.x и более ранних: Для реализации mTLS в составе системы добавлены новые компоненты:
Особенности обновления с версии 7.x и более ранних: ca - встроенный УЦ для выпуска сертификатов mTLS. Устанавливается автоматически вместе с Сервером Администрирования (arm) и не требует дополнительных настроек.
Особенности обновления с версии 7.x и более ранних: Помимо новых компонент в 8.2 обязательным компонентом стал Сервер SCEP. Если SCEP ранее не использовался, то его лучше размещать на той же виртуальной машине, что и Сервер MDM (см. таблицу 2.1 – Системные требования для основных компонентов). после обновления системы необходимо:
Особенности обновления с версии 7.x и более ранних: Если в системе ранее не использовался сервер SCEP, то в разделе АРМ "Объекты учета" -> "Подключения к серверам" скопировать настройки из MDMServer в настройки SCEPServer. В этом случае Сервер SCEP будет использовать тот же порт, что и Сервер MDM.
Особенности обновления с версии 7.x и более ранних: Если в системе ранее был установлен сервер SCEP возможны два варианта: либо продолжить использовать его на старом порту, либо перейти на использование порта Cервера MDM.. Для продолжения использования прежнего порта Сервера SCEP, установленного с предыдущей версией, необходимо открыть порт в конфигурационном файле docker-compose server (раскомментировать строку # - ${BIND_ADDR}:8082:8082 # scep (old port)). Во втором случае необходимо в разделе АРМ "Объекты учета" -> "Подключения к серверам" скопировать настройки из MDMServer в настройки SCEPServer.
Особенности обновления с версии 7.x и более ранних: Если трафик TLS в сторону Серверов управления (компоненты mdm и winmdm) терминируется на внешнем прокси сервере, необходимо настроить внешний прокси сервер:
Особенности обновления с версии 7.x и более ранних: Прокси сервер не должен проверять, что сертификат mTLS клиента выпущен публичным доверенным УЦ. Клиентский сертификат mTLS начиная с версии 8.2 выпускается встроенным УЦ. Корневой сертификат встроенного УЦ самоподписанный. 
Пример настройки внешнего прокси-сервера:
Особенности обновления с версии 7.x и более ранних: Прокси сервер должен передавать в http заголовках параметры клиентского сертификата mTLS и параметры подключения по WebSocket. 
Пример настройки внешнего прокси-сервер:
Особенности обновления с версии 7.x и более ранних: Переход на сертификаты mTLS, ранее подключенных устройств iOS будет происходить не сразу. Из-за особенностей реализации смену сертификата можно произвести только после того, как устройство обновит свой токен. Как правило обновление токенов производится раз в месяц.
Особенности обновления с версии 7.x и более ранних: При обновлении из журнала синхронизации с AD будут удалены все записи. Обусловлено изменением способа синхронизации и состава записей в журнале.
Особенности обновления с версии 7.x и более ранних: После миграции изменения правил синхронизации возможно только при отключенной автосинхронизации.
Особенности обновления с версии 7.x и более ранних: Если в Вашей системе использовался запрет Google Play в профилях, то необходимо выполнить следующие действия (ДО обновления к версии 8.2):
Особенности обновления с версии 7.x и более ранних: Если в разделе "Объекты учета" -> "Приложения" нет приложения Google Play со следующими параметрами, то его необходимо добавить:
Особенности обновления с версии 7.x и более ранних: Платформа: Android.
Особенности обновления с версии 7.x и более ранних: Тип приложения: Некорпоративное,
Особенности обновления с версии 7.x и более ранних: Наименование: "Google Play",
Особенности обновления с версии 7.x и более ранних: UID: "com.android.vending",
Особенности обновления с версии 7.x и более ранних: Владелец: root,
Особенности обновления с версии 7.x и более ранних: Создать правило управления приложениями на удаление приложения Google Play со следующими параметрами:
Особенности обновления с версии 7.x и более ранних: Название произвольное (например: "Заблокировать Google Play"),
Особенности обновления с версии 7.x и более ранних: Место установки: Устройство,
Особенности обновления с версии 7.x и более ранних: Приложение должно быть установлено: Нет,
Особенности обновления с версии 7.x и более ранних: Владелец: root,
Особенности обновления с версии 7.x и более ранних: Назначить правило на корень дерева ОШС.
Особенности обновления с версии 7.x и более ранних: Если в Вашей компании имеются устройства, использующие контейнер КNOX или Рабочий профиль Android и нужно обеспечить запрет Google Play внутри контейнеров, то необходимо дополнительно создать правило аналогичное п.2 и п.3, но местом установки выбрать - контейнер.
Особенности обновления с версии 7.x и более ранних: После настройки всех правил необходимо задать значение политики управления Google Play (во всех профилях ограничений) в значение - Не задано.
Особенности обновления с версии 7.x и более ранних: Провести обновление.
Особенности обновления с версии 7.x и более ранних: Если используются файрволл, антивирус, или DLP система, проверьте, что они не блокируют трафик wss между рабочим местом администратора, с которого запускается консоль администрирования арм, и сервером администрирования.
Обновление серверной части до версии 10.x: Для обновления уже установленной «UEM SafeMobile» до текущей версии дополнительно в установочный комплект входит файл db-postgresql-patch-<version>.tar.gz, (например db-postgresql-patch-9.0-34-g23dd384.tar.gz) , который рекомендуется распаковать в каталог /tmp/ командой:
Обновление серверной части до версии 10.x: tar xzvf db-postgresql-patch-*.*.tar.gz -C /tmp/
Обновление серверной части до версии 10.x: Чтобы обновить систему следует выполнить следующие операции (предполагается, что система установлена в /opt/emm):
Обновление серверной части до версии 10.x: Остановить docker-контейнеры на всех серверах следующей командой:
Обновление серверной части до версии 10.x: cd /opt/emm && docker-compose down -v
Обновление серверной части до версии 10.x: Установить новые docker-образы серверных компонентов из архива emm-docker.tar.gz посредством команды:
Обновление серверной части до версии 10.x: docker load -i emm-docker.tar.gz
Обновление серверной части до версии 10.x: Переименовать каталог «emm» в «emm-old»:
Обновление серверной части до версии 10.x: mv /opt/emm /opt/emm-old
Обновление серверной части до версии 10.x: Создать каталог «/opt/emm», распаковать в него архив с конфигурацией компонентов и скрипт обновления БД с помощью команд:
Обновление серверной части до версии 10.x: mkdir /opt/emm && tar xzvf emm-config.tar.gz -C /opt/emm
Обновление серверной части до версии 10.x: И пройти мастер первоначальной настройки setup.sh, выбирая компоненты, необходимые на данном сервере. SSL сертификаты генерировать не нужно, т.к. они уже есть в каталоге «emm-old».
Обновление серверной части до версии 10.x: Установить патчи БД из каталога /tmp/ посредством скрипта install_patch.sh следующей командой:
Обновление серверной части до версии 10.x: mkdir /tmp/ && ./install_patch.sh -- -h 127.0.0.1
Обновление серверной части до версии 10.x: При запуске скрипта ./install_patch.sh, до первого патча автоматически создаётся бэкап БД в каталоге /tmp
Обновление серверной части до версии 10.x: Дополнительные настройки скрипта можно уточнить командой:
Обновление серверной части до версии 10.x: ./install_patch.sh --help
Обновление серверной части до версии 10.x: В каталоге «/opt/emm/config» содержатся сформированные конфигурационные файлы компонентов SafeMobile. Следует сравнить конфигурационные файлы релиза 9.x в каталоге «emm» с файлами в каталоге «emm-old» и при необходимости дополнить их измененными настройками из старых файлов.
Обновление серверной части до версии 10.x: Скопировать файлы формата CRT, KEY, PEM из каталога «emm-old» в «emm». Пример команд приведен ниже:
Обновление серверной части до версии 10.x: cp /opt/emm-old/ca.pem /opt/emm/
Обновление серверной части до версии 10.x: cd /opt/emm-old/config
Обновление серверной части до версии 10.x: cp /opt/emm-old/config/$(ls *.crt *.key MdmPush.pem) /opt/emm/config/
Обновление серверной части до версии 10.x: cd /opt/emm-old/config/nginx/
Обновление серверной части до версии 10.x: cp /opt/emm-old/config/nginx/$(ls *.crt *.key) /opt/emm/config/nginx/
Обновление серверной части до версии 10.x: Запустить docker-контейнеры на всех серверах с помощью команды:
Обновление серверной части до версии 10.x: cd /opt/emm && docker-compose up -d
Обновление серверной части до версии 10.x: Проверить наличие созданных docker-образов и docker-контейнеров следующими командами:
Обновление серверной части до версии 10.x: docker images -a
Обновление серверной части до версии 10.x: docker ps -a
Обновление серверной части до версии 10.x: После запуска и настройки всех контейнеров можно выполнить команду
Обновление серверной части до версии 10.x: docker image prune -a
Обновление серверной части до версии 10.x: она удаляет docker-образы, которые не задействованы.
Особенность применения профилей после обновления с версии 4.4.x до 8.x: В версии 4.5 и последующих, изменился способ расчета результирующих политик профилей: «Профили парольных политик», «Профили ограничений», «Профили режима киоска», «Профиль настроек монитора Android», «Профиль настроек монитора Android», «Профиль управления датой и временем Samsung Knox». Если в предыдущей версии применялись самые строгие политики из всех назначенных профилей, то в SafeMobile 8.x, после обновления будет применяться политика из ближайшего к МСК профиля. Под «ближайшим» понимается назначение, сделанное на ближайший к устройству узел в цепочке: устройство - пользователь - подразделение - корень ОШС.
Особенность применения профилей после обновления с версии 4.4.x до 8.x: Перед обновлением SafeMobile с версии 4.4.x до версии 8.x выполнить следующие действия:
Особенность применения профилей после обновления с версии 4.4.x до 8.x: Проверить содержимое профилей: необходимо, чтобы в профилях одного типа, назначенных и подразделениям, и сотрудникам и, возможно, отдельным устройствам не были заданы разные значения одних и тех же политик. Чтобы сохранить поведение системы после обновления следует выбрать самое строгое значение политики, указать его в самом «верхнем» профиле, назначенном выше всего в ОШС, а в профилях «ниже» указать значение «не задано».
Особенность применения профилей после обновления с версии 4.4.x до 8.x: Убедиться, что нет профилей одного типа, назначенных на одно и то же подразделение или сотрудника. Если такие профили найдутся, оставить только один.
Особенность применения профилей после обновления с версии 4.4.x до 8.x: После обновления необходимо зайти суперпользователем root и раздать необходимые полномочия локальным администраторам, созданным в предыдущих версиях.
Работа с дампом БД, полученным перед патчем до новой версии: При обновлении будет сформирован дамп БД в каталоге /tmp. Имя файла дампа <"имя-бд"_"имя-схемы"_"версия-БД-до-патча"-"дата-время-создания".dmp>. Например: если имя БД и имя схемы sphone, а версия до обновления 5.0.4, то файл дампа будет иметь имя sphone_sphone_5.0.4-20220613_1214.dmp. В том же каталоге будет находиться файл лога снятия дампа. Он будет иметь такое же имя, а расширение .log.
Работа с дампом БД, полученным перед патчем до новой версии: Если потребуется восстановление БД из дампа, сначала необходимо очистить схему БД. Для этого выполнить следующие действия:
Работа с дампом БД, полученным перед патчем до новой версии: Распаковать архив инсталлятора БД нужной версии в любой каталог на сервере (или если он уже распакован, то следует перейти в этот каталог).
Работа с дампом БД, полученным перед патчем до новой версии: Очистить схему БД, выполнив команду от пользователя postgres (из-под root-а выполнить su - postgres):
Работа с дампом БД, полученным перед патчем до новой версии: ./setup.sh --dump-prepare
Работа с дампом БД, полученным перед патчем до новой версии: После этого можно приступить к восстановлению БД из дампа:
Работа с дампом БД, полученным перед патчем до новой версии: pg_restore -O -h 127.0.0.1 -U sphone -d sphone /tmp/sphone_sphone_9.0-20240329_1214.dmp
Работа с дампом БД, полученным перед патчем до новой версии: где:
pg_restore − команда для восстановления БД из дампа;
Работа с дампом БД, полученным перед патчем до новой версии: -h 127.0.0.1 − установить соединение с хостом указанного IP;
Работа с дампом БД, полученным перед патчем до новой версии: -U sphone − соединиться как пользователь postgresql sphone (можно посмотреть в конфигурационном файле db.yml параметр user);
Работа с дампом БД, полученным перед патчем до новой версии: -d sphone − имя целевой БД (можно посмотреть в конфигурационном файле db.yml параметр name);
Работа с дампом БД, полученным перед патчем до новой версии: sphone_sphone_6.0.1-20230513_1214.dmp − имя файла дампа.
Работа с дампом БД, полученным перед патчем до новой версии: При восстановлении дампа вначале может возникнуть ошибка:
Работа с дампом БД, полученным перед патчем до новой версии: pg_restore: error: could not execute query: ERROR:  permission denied for database sphone
Работа с дампом БД, полученным перед патчем до новой версии: Command was: CREATE SCHEMA sphone;
Работа с дампом БД, полученным перед патчем до новой версии: Это происходит потому, что схема уже существует, но, если в дальнейшем ошибок не возникает, значит импорт проходит нормально.
Особенности обновления БД с версии 5.0.3 и более ранних: Для обновления уже установленной «UEM SafeMobile» версии 5.0.3 и более ранних, в установочный комплект дополнительно входит патч, посредством которого задания, выполняющиеся по расписанию (job's), удаляются из БД postgres и создаются в БД sphone. Для этого в БД sphone создается схема pgagent, в которой и будет храниться информация об этих заданиях.
Особенности обновления БД с версии 5.0.3 и более ранних: После установки патча следует выполнить следующие действия:
Особенности обновления БД с версии 5.0.3 и более ранних: Вывести список процессов, в названии которых есть подстрока pgagent:
Особенности обновления БД с версии 5.0.3 и более ранних: systemctl list-units | grep pgagent
Особенности обновления БД с версии 5.0.3 и более ранних: Для PostgreSQL 11, установленного в CentOS сервис будет называться pgagent_11.service.
Особенности обновления БД с версии 5.0.3 и более ранних: Следует остановить сервис и убрать его из автозагрузки:
Особенности обновления БД с версии 5.0.3 и более ранних: systemctl stop pgagent_11
Особенности обновления БД с версии 5.0.3 и более ранних: systemctl disable pgagent_11
Особенности обновления БД с версии 5.0.3 и более ранних: Удалить пакет pgagent_11 из системы:
Особенности обновления БД с версии 5.0.3 и более ранних: yum remove pgagent_11
Управление серверными компонентами «UEM SafeMobile»: Просмотреть текущие версии установленных компонентов можно следующими командами:
Управление серверными компонентами «UEM SafeMobile»: docker ps -a
Управление серверными компонентами «UEM SafeMobile»: При изменениях в конфигурации серверных компонентов следует перезапустить docker-контейнеры следующей командой:
Управление серверными компонентами «UEM SafeMobile»: cd /opt/emm && docker-compose restart <имя компонента>
Управление серверными компонентами «UEM SafeMobile»: Обновление docker-образов осуществляется следующими командами, при этом необходимо сначала остановить и удалить docker-контейнеры, затем обновить версии в файле «.env» и запустить docker-контейнеры:
Управление серверными компонентами «UEM SafeMobile»: docker-compose down -v
Управление серверными компонентами «UEM SafeMobile»: docker load -i emm-docker.tar.gz
Управление серверными компонентами «UEM SafeMobile»: docker-compose up -d
Управление серверными компонентами «UEM SafeMobile»: При внесении изменений в файлы «.env» или «docker-compose.yml», следует пересоздать docker-контейнеры командой:
Управление серверными компонентами «UEM SafeMobile»: docker-compose up -d
Проверка работоспособности «UEM SafeMobile»: После установки и запуска сервисы apple-mdm-push и fcmpushserver будут находиться в циклической перезагрузке, пока не будут получены валидные файлы MDMPush.pem и firebase.json, соответственно.
Проверка работоспособности «UEM SafeMobile»: Для контроля работоспособности «UEM SafeMobile» требуется:
Проверка работоспособности «UEM SafeMobile»: Войти в АРМ Администратора SafeMobile, для этого в адресной строке браузера ввести https://ip-address:8443, (вместо <ip-address> следует указать адрес сервера администрирования). Должна отобразиться страница авторизации, для входа понадобится ввести логин и пароль действующей учетной записи администратора.
Проверка работоспособности «UEM SafeMobile»: В таблице МСК главного окна выбрать подключенный, незаблокированный и доступный для управления комплект в соответствии с рисунком 8.1, у которого:
Проверка работоспособности «UEM SafeMobile»: состояние соединения МСК, которое отображается в столбце «Статус»,  – в сети;
Проверка работоспособности «UEM SafeMobile»: состояние блокировки МСК, которое отображается в столбце «Статус»,  – не заблокирован;
Проверка работоспособности «UEM SafeMobile»: состояние управления устройством, которое отображается в столбце «Статус»,  – доступно для управления.
Проверка работоспособности «UEM SafeMobile»: Рисунок 8.1 − Выбор подключенного незаблокированного комплекта
Проверка работоспособности «UEM SafeMobile»: В главном меню выбрать раздел «Команды» и отправить на устройство команду «Переподключение» соответствии с рисунком 8.2, с параметром 10 с. Затем в окне «Уведомления» нажать кнопку «ОК».
Проверка работоспособности «UEM SafeMobile»: Рисунок 8.2 − Отправка команды «Переподключение»
Проверка работоспособности «UEM SafeMobile»: Дождаться результата выполнения действия: когда значение в разделе «Действие» изменится на значение, отличное от «Ожидание результата»:
Проверка работоспособности «UEM SafeMobile»: результат «Нормальное завершение» свидетельствует о работоспособности «UEM SafeMobile» (рисунок 8.3);
Проверка работоспособности «UEM SafeMobile»: Рисунок 8.3 − Результат команды «Переподключение»
Проверка работоспособности «UEM SafeMobile»: значение результата, отличное от «Нормальное завершение», свидетельствует о возможном нарушении работоспособности системы.
Приложение А – Диагностические сообщения при запуске АРМ.: Установлена настройка: ad.cert_disable_validation: true
Имитация текущей даты: 2023-09-12T07:00Z
Приложение А – Диагностические сообщения при запуске АРМ.: Содержание файла настроек:
Приложение А – Диагностические сообщения при запуске АРМ.: Сообщение системы:
Приложение А – Диагностические сообщения при запуске АРМ.: Установлена настройка: 
'auth-provider.active-directory.on: true', 'ad.url: ldap://192.168.15.150'
Имитация текущей даты: 2023-09-12T07:00Z
Приложение А – Диагностические сообщения при запуске АРМ.: Содержание файла настроек:
Приложение А – Диагностические сообщения при запуске АРМ.: Сообщение системы:
Приложение А – Диагностические сообщения при запуске АРМ.: Установлена настройка: 
auth-provider.active-directory.on: false
Имитация текущей даты: 2023-09-12T07:00Z
Приложение А – Диагностические сообщения при запуске АРМ.: Содержание файла настроек:
Приложение А – Диагностические сообщения при запуске АРМ.: Сообщение системы:
Приложение А – Диагностические сообщения при запуске АРМ.: Установлена настройка: 
ad.cert: file_any_no_exists - файл с сертификатом не существует'
Имитация текущей даты: 2023-09-12T07:00Z
Приложение А – Диагностические сообщения при запуске АРМ.: Содержание файла настроек:
Приложение А – Диагностические сообщения при запуске АРМ.: Сообщение системы:
Приложение А – Диагностические сообщения при запуске АРМ.: Установлена настройка: 
ad.cert - файл с сертификатом совпадает с серверным.
Имитация текущей даты: 2023-09-12T07:00Z
Приложение А – Диагностические сообщения при запуске АРМ.: Содержание файла настроек:
Приложение А – Диагностические сообщения при запуске АРМ.: Сообщение системы:
Приложение А – Диагностические сообщения при запуске АРМ.: Установлена настройка: 
ad.cert - файл с сертификатом валидный 
Текущее время раньше сертификатного.
Имитация текущей даты: 2022-12-01T07:05Z
Приложение А – Диагностические сообщения при запуске АРМ.: The certificate has not yet started validity:src/test/resources/192_168_15_150__636.pem
У сертификата: NotBefore:2022-12-02T07:05Z, NotAfter:2023-12-02T07:05Z
Приложение А – Диагностические сообщения при запуске АРМ.: Содержание файла настроек:
Приложение А – Диагностические сообщения при запуске АРМ.: Сообщение системы:
Приложение А – Диагностические сообщения при запуске АРМ.: Установлена настройка: 
ad.cert - файл с сертификатом валидный
Текущее время позже сертификатного.
Имитация текущей даты: 2023-12-03T07:05Z
The certificate has not yet started validity:src/test/resources/192_168_15_150__636.pem
У сертификата: NotBefore:2022-12-02T07:05Z, NotAfter:2023-12-02T07:05Z
Приложение А – Диагностические сообщения при запуске АРМ.: Содержание файла настроек:
Приложение А – Диагностические сообщения при запуске АРМ.: Сообщение системы:
Приложение А – Диагностические сообщения при запуске АРМ.: Установлена настройка: 
ad.cert - файл с сертификатом чужой
Имитация текущей даты: 2022-06-25T08:01Z
Приложение А – Диагностические сообщения при запуске АРМ.: Содержание файла настроек:
Приложение А – Диагностические сообщения при запуске АРМ.: Сообщение системы:
Приложение А – Диагностические сообщения при запуске АРМ.: Настройки секции mail с ССО2, выключена
Имитация текущей даты: 2022-06-25T08:01Z
Приложение А – Диагностические сообщения при запуске АРМ.: Содержание файла настроек:
Приложение А – Диагностические сообщения при запуске АРМ.: Сообщение системы:
Приложение А – Диагностические сообщения при запуске АРМ.: Настройки секции mail с ССО2, включена.
Имитация текущей даты: 2022-06-25T08:01Z
Приложение А – Диагностические сообщения при запуске АРМ.: Содержание файла настроек:
Приложение А – Диагностические сообщения при запуске АРМ.: Сообщение системы:
Приложение А – Диагностические сообщения при запуске АРМ.: Проверка наличия каталога для временных файлов отчётов - не существует.
Имитация текущей даты: 2022-06-25T08:01Z
Приложение А – Диагностические сообщения при запуске АРМ.: Содержание файла настроек:
Приложение А – Диагностические сообщения при запуске АРМ.: Сообщение системы:
Приложение А – Диагностические сообщения при запуске АРМ.: Проверка наличия каталога для временных файлов отчётов – существует.
Имитация текущей даты: 2022-06-25T08:01Z
Приложение А – Диагностические сообщения при запуске АРМ.: Содержание файла настроек:
Приложение А – Диагностические сообщения при запуске АРМ.: Сообщение системы: